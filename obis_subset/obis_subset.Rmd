---
title: "Basic overview of subset of OBIS occurrence data"
author: ~
date: '2019-07-23'
categories: []
tags: []
---

```{r mpa compare imports, include=FALSE}
library(glue)
# also uses robis
source("./../R/obis_cache.R")
```


```{r define region of interest}
roi <- "MULTIPOLYGON (((-83.15 25.65, -80.066667 25.65, -80.066667 24.3, -83.15 24.3, -83.15 25.65)))"
# special use areas manually transcribed from images at
# https://floridakeys.noaa.gov/zones/special/welcome.html
# converted from min/degrees to decimal degrees using
# https://www.pgc.umn.edu/apps/convert/
# https://floridakeys.noaa.gov/zones/special/easternsambo.html
```

```{r fetch occurrence data}
species_name <- "Ocyurus chrysurus"
species_name_safe <- sanitize_query_id(species_name)
roi_query_id  <- glue( "query_id_placeholder_{species_name_safe}")
if (has_cache(roi_query_id)){
    inside_occurrence <- load_cache(roi_query_id)
} else {
    occurrences <- robis::occurrence(
        species_name,
        geometry = roi
    )
    save_cache(roi_query_id, occurrences)
}
```

```{r occurrences timeseries, echo=FALSE}
ggplot2::ggplot(occurrences) + ggplot2::geom_bar(ggplot2::aes(date_year), width = 1)
```


```{python}
# print head of records from R
print(r.occurrences[:3])
```